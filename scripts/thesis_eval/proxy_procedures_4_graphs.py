import numpy as np
import matplotlib
matplotlib.use("pgf")
matplotlib.rcParams.update({
    "pgf.texsystem": "pdflatex",
    "text.usetex": True,
    "pgf.rcfonts": False,
    "font.family": "serif",
    "font.serif": ["Palatino"],
    "axes.labelsize": 11,
    "font.size": 11,
    "legend.fontsize": 10,
    "xtick.labelsize": 10,
    "ytick.labelsize": 10,
})

import matplotlib.pyplot as plt

# ============================================================
# DATA STRUCTURE
# Each sample = (Total, R1, R2, R3)
# ============================================================

data = {
    '100% Sampling Rate': {
        16: [
            (617585.0666666667, 186762, 77682.53333333334, 353140.5333333333),
            (412620.1875, 57674.3125, 46930.1875, 308015.6875),
            (789125.5625, 83772.6875, 100453.625, 604899.25),
            (709503.4375, 63103.25, 67303.75, 579096.4375),
            (1.1965495625e+06, 87689, 74828, 1.0340325625e+06),
            (804851.0625, 63496.4375, 108229.125, 633125.5),
            (769201.1875, 81520, 140376.25, 547304.9375),
            (654484.0625, 84299.5625, 93837.4375, 476347.0625),
            (602732.4375, 69695.6875, 117296.1875, 415740.5625),
            (638054, 76165.4375, 83352.3125, 478536.25),
        ],
        32: [
            (1.4317530625e+06, 162554.6875, 176042.90625, 1.09315546875e+06),
            (1.41975365625e+06, 143439.8125, 202155.46875, 1.074158375e+06),
            (1.512497e+06, 159763.21875, 210751.5625, 1.14198221875e+06),
            (2.24585103125e+06, 359921.625, 445847.25, 1.44008215625e+06),
            (1.60200390625e+06, 97980.03125, 179909.15625, 1.32411471875e+06),
            (1.32764975e+06, 108309.46875, 180995.9375, 1.03834434375e+06),
            (1.1987275e+06, 95440.15625, 164262.8125, 939024.53125),
            (1.155067875e+06, 136664.90625, 222595.96875, 795807),
            (1.33561703125e+06, 171626.4375, 187852.34375, 976138.25),
            (1.4090183870967743e+06, 137743.12903225806, 207424.06451612903, 1.0638511935483871e+06),
        ],
        64: [
            (2.857138171875e+06, 153470.671875, 294736.171875, 2.408931328125e+06),
            (3.34811328125e+06, 218100.046875, 334477.671875, 2.7955355625e+06),
            (2.935894359375e+06, 261270.140625, 440861.859375, 2.233762359375e+06),
            (3.3878243333333335e+06, 325017.7619047619, 532972.0476190476, 2.529834523809524e+06),
            (3.6004618125e+06, 264908.265625, 389368.3125, 2.946185234375e+06),
            (1.768833859375e+06, 196924.46875, 331735.890625, 1.2401735e+06),
            (2.57935315625e+06, 239406.75, 453767.015625, 1.886179390625e+06),
            (2.360500453125e+06, 225321.5625, 380462.734375, 1.75471615625e+06),
            (3.110256234375e+06, 289120.828125, 494155.578125, 2.326979828125e+06),
            (3.8397066875e+06, 246940.28125, 342356.015625, 3.250410390625e+06),
        ],
        128: [
            (5.193668875e+06, 520085.765625, 876326.2890625, 3.7972568203125e+06),
            (5.7915343125e+06, 552188.7421875, 841949.5625, 4.3973960078125e+06),
            (6.3580765625e+06, 967757.09375, 1.2621458359375e+06, 4.1281736328125e+06),
            (5.01355821875e+06, 350419.6015625, 613864.2109375, 4.04927440625e+06),
            (6.6050218671875e+06, 480036.1640625, 1.23003853125e+06, 4.894947171875e+06),
            (5.2516642890625e+06, 516204.2890625, 889148.4375, 3.8463115625e+06),
            (6.24187390625e+06, 708101.3046875, 1.5277590078125e+06, 4.00601359375e+06),
            (6.8174805625e+06, 473692.171875, 776859.640625, 5.56692875e+06),
            (7.21068328125e+06, 460464.8984375, 893327.6484375, 5.856890734375e+06),
            (6.7982620625e+06, 603555.2421875, 912124.8359375, 5.282581984375e+06),
        ],
        256: [
            (1.211070410546875e+07, 1.10318479296875e+06, 1.51114361328125e+06, 9.49637569921875e+06),
            (1.0975162796875e+07, 924712.84765625, 1.5111556171875e+06, 8.53929433203125e+06),
            (9.10918546875e+06, 1.22221808984375e+06, 1.68357069921875e+06, 6.2033966796875e+06),
            (1.032510136328125e+07, 1.18604279296875e+06, 1.21233851953125e+06, 7.92672005078125e+06),
            (1.06970140625e+07, 999881.6015625, 1.12801738671875e+06, 8.56911507421875e+06),
            (8.84391190625e+06, 1.09424397265625e+06, 1.07224026953125e+06, 6.6774276640625e+06),
            (1.21091052734375e+07, 1.12546245703125e+06, 1.68368128125e+06, 9.29996153515625e+06),
            (1.12234096328125e+07, 1.2686399921875e+06, 1.72890148046875e+06, 8.22586816015625e+06),
            (1.1126563101960784e+07, 1.2030283490196078e+06, 1.5519440078431373e+06, 8.3715907450980395e+06),
            (1.3018711262745097e+07, 1.1814090588235294e+06, 1.5644380823529412e+06, 1.0272864121568628e+07),
        ],
        384: [
            (1.8980728736979168e+07, 2.3752323671875e+06, 2.9415031015625e+06, 1.3663993268229166e+07),
            (1.6584489236979166e+07, 1.4934332916666667e+06, 2.0362869036458333e+06, 1.3054769041666666e+07),
            (2.022129509375e+07, 2.0235430052083333e+06, 3.7998223020833335e+06, 1.4397929786458334e+07),
            (1.7092875817708332e+07, 1.4965272760416667e+06, 1.8813304973958333e+06, 1.3715018044270834e+07),
            (1.9459679044270832e+07, 1.6204672552083333e+06, 2.686479953125e+06, 1.51527318359375e+07),
            (1.79581666640625e+07, 1.949438109375e+06, 1.8903353125e+06, 1.41183932421875e+07),
            (1.6959773575520832e+07, 1.9881436744791667e+06, 2.5978680625e+06, 1.2373761838541666e+07),
            (1.6261103005208334e+07, 1.9738901223958333e+06, 2.3709393880208335e+06, 1.1916273494791666e+07),
            (1.80813074308094e+07, 1.863674088772846e+06, 3.5266244856396867e+06, 1.2691008856396867e+07),
            (1.936565082722513e+07, 2.284389829842932e+06, 3.2889674712041887e+06, 1.379229352617801e+07),
        ],
        512: [
            (2.683893734765625e+07, 2.796747212890625e+06, 3.86086592578125e+06, 2.0181324208984375e+07),
            (2.4386681939453125e+07, 2.4841796953125e+06, 3.46904823046875e+06, 1.8433454013671875e+07),
            (2.4296743436399218e+07, 2.5245909452054794e+06, 3.6425312818003916e+06, 1.8129621209393345e+07),
            (2.722144215625e+07, 3.53249316796875e+06, 4.52319084765625e+06, 1.9165758140625e+07),
            (2.3864169544921875e+07, 3.866554193359375e+06, 2.95181432421875e+06, 1.704580102734375e+07),
            (2.2457640162109375e+07, 2.11697180859375e+06, 3.724154708984375e+06, 1.661651364453125e+07),
            (2.35780836888454e+07, 2.735631264187867e+06, 4.1672545479452056e+06, 1.667519787671233e+07),
            (2.300614515234375e+07, 2.62717769921875e+06, 3.45037706640625e+06, 1.692859038671875e+07),
            (2.540278598828125e+07, 2.6983902734375e+06, 4.09445884765625e+06, 1.86099368671875e+07),
            (2.4925359718199607e+07, 2.9752425714285714e+06, 3.6758555342465756e+06, 1.827426161252446e+07),
        ],
    },
    '50% Sampling Rate': {
        16: [
            (7.551379375e+05, 1.76055625e+05, 1.948135625e+05, 3.84268750e+05),
            (6.85620000e+05, 1.520784375e+05, 6.94680000e+04, 4.640735625e+05),
            (1.8883850625e+06, 1.11087750e+05, 1.516174375e+05, 1.625679875e+06),
            (7.399055625e+05, 8.07661875e+04, 7.14275625e+04, 5.877118125e+05),
            (1.061234875e+06, 8.13337500e+04, 9.34738750e+04, 8.86427250e+05),
            (6.78367250e+05, 7.69046250e+04, 7.32355625e+04, 5.282270625e+05),
            (7.26186750e+05, 1.10454250e+05, 8.13030625e+04, 5.344294375e+05),
            (6.827096875e+05, 6.01036875e+04, 9.99472500e+04, 5.22658750e+05),
            (5.99019375e+05, 8.90906875e+04, 8.17403125e+04, 4.28188375e+05),
            (6.565249375e+05, 1.81477125e+05, 1.024646875e+05, 3.72583125e+05),
        ],
        32: [
            (1.8788266875e+06, 1.46250875e+05, 2.4015240625e+05, 1.49242340625e+06),
            (1.23204484375e+06, 1.17159875e+05, 1.835539375e+05, 9.3133103125e+05),
            (1.44354409375e+06, 1.3940478125e+05, 1.9341853125e+05, 1.11072078125e+06),
            (1.4113074375e+06, 1.09902250e+05, 1.17026750e+05, 1.1843784375e+06),
            (1.175494125e+06, 2.0093165625e+05, 1.715353125e+05, 8.0302715625e+05),
            (1.07880765625e+06, 1.1019378125e+05, 1.0553865625e+05, 8.6307521875e+05),
            (1.33967878125e+06, 1.44021500e+05, 2.491715625e+05, 9.4648571875e+05),
            (1.40629321875e+06, 1.5839353125e+05, 2.0639834375e+05, 1.04150134375e+06),
            (1.324344e+06, 1.3892778125e+05, 1.962499375e+05, 9.8916628125e+05),
            (1.1856598125e+06, 1.364044375e+05, 1.9838009375e+05, 8.5087528125e+05),
        ],
        64: [
            (3.088385953125e+06, 2.68868859375e+05, 4.03201203125e+05, 2.416315890625e+06),
            (2.0394258125e+06, 2.27069453125e+05, 2.96754359375e+05, 1.515602e+06),
            (1.983744875e+06, 2.2579325e+05, 4.086095e+05, 1.349342125e+06),
            (1.848579015625e+06, 2.52014796875e+05, 4.05452921875e+05, 1.191111296875e+06),
            (2.3064068125e+06, 1.973189375e+05, 2.802990625e+05, 1.8287888125e+06),
            (3.15687790625e+06, 2.722486875e+05, 3.78681625e+05, 2.50594759375e+06),
            (2.953587609375e+06, 2.33600546875e+05, 3.4322621875e+05, 2.37676084375e+06),
            (2.26884209375e+06, 2.70981015625e+05, 4.11990859375e+05, 1.58587021875e+06),
            (3.528940109375e+06, 2.92707265625e+05, 4.04526625e+05, 2.83170621875e+06),
            (3.740531890625e+06, 7.13443640625e+05, 9.77410703125e+05, 2.049677546875e+06),
        ],
        128: [
            (3.926228140625e+06, 5.3119653125e+05, 8.293366875e+05, 2.565694921875e+06),
            (6.3011554765625e+06, 5.823095e+05, 1.24910703125e+06, 4.4697389453125e+06),
            (6.704554828125e+06, 5.411125625e+05, 9.98764359375e+05, 5.16467790625e+06),
            (5.5511357109375e+06, 5.25817015625e+05, 7.7388615625e+05, 4.2514325390625e+06),
            (5.3731612109375e+06, 6.414718125e+05, 1.23682603125e+06, 3.4948633671875e+06),
            (5.804059765625e+06, 1.173421375e+06, 1.6843898203125e+06, 2.9462485703125e+06),
            (5.6733804375e+06, 5.03352703125e+05, 7.664081484375e+05, 4.4036195859375e+06),
            (5.4623921875e+06, 5.501393515625e+05, 7.782083203125e+05, 4.134044515625e+06),
            (5.791032875e+06, 6.0683246875e+05, 8.319755234375e+05, 4.3522248828125e+06),
            (4.53239046875e+06, 3.476972109375e+05, 5.427780078125e+05, 3.64191525e+06),
        ],
        256: [
            (1.1520068875e+07, 1.1704914609375e+06, 2.7455081953125e+06, 7.60406921875e+06),
            (1.201860122265625e+07, 8.5431082421875e+05, 1.57015759765625e+06, 9.59413280078125e+06),
            (1.202334921484375e+07, 1.20217933203125e+06, 1.80553382421875e+06, 9.01563605859375e+06),
            (1.12650743828125e+07, 1.2009075703125e+06, 1.26232077734375e+06, 8.80184603515625e+06),
            (1.130129416015625e+07, 9.7423427734375e+05, 1.48628291796875e+06, 8.84077696484375e+06),
            (1.3729738484375e+07, 1.09207612109375e+06, 2.14005346484375e+06, 1.04976088984375e+07),
            (8.84284393359375e+06, 8.51571e+05, 9.457690625e+05, 7.04550387109375e+06),
            (9.89317834765625e+06, 8.0760332421875e+05, 1.2909463203125e+06, 7.794628703125e+06),
            (1.252983890625e+07, 1.22343040234375e+06, 1.72549687890625e+06, 9.580911625e+06),
            (1.089114771875e+07, 1.19251965234375e+06, 1.584344359375e+06, 8.11428370703125e+06),
        ],
        384: [
            (1.67932223125e+07, 1.8771023958333333e+06, 2.443487609375e+06, 1.2472632307291666e+07),
            (1.7136174671875e+07, 2.1183550208333335e+06, 2.8800289322916665e+06, 1.213779071875e+07),
            (1.8452479942708332e+07, 3.0541261614583335e+06, 2.872101484375e+06, 1.2526252296875e+07),
            (1.54700121015625e+07, 2.0379830911458333e+06, 2.0400180729166667e+06, 1.13920109375e+07),
            (1.6596187135416666e+07, 1.8892516276041667e+06, 2.3886631666666665e+06, 1.2318272341145834e+07),
            (1.9410911927083332e+07, 1.8954177369791667e+06, 2.6817215234375e+06, 1.4833772666666666e+07),
            (1.6607654111979166e+07, 1.7511527734375e+06, 2.4800386588541665e+06, 1.23764626796875e+07),
            (1.8479345877604168e+07, 1.8230292526041667e+06, 2.9732034973958335e+06, 1.3683113127604166e+07),
            (1.8533347372395832e+07, 1.8872071276041667e+06, 3.2258583359375e+06, 1.3420281908854166e+07),
            (1.6364605994791666e+07, 2.5621581171875e+06, 2.476305421875e+06, 1.1326142455729166e+07),
        ],
        512: [
            (2.495588485714286e+07, 3.250795684931507e+06, 4.091463336594912e+06, 1.761362583561644e+07),
            (2.5396262334637966e+07, 3.242477698630137e+06, 4.201182138943248e+06, 1.795260249706458e+07),
            (2.346494451953125e+07, 2.608029515625e+06, 3.578519802734375e+06, 1.7278395201171875e+07),
            (2.3830444549902152e+07, 3.1603948375733853e+06, 3.2382747181996084e+06, 1.743177499412916e+07),
            (2.46160528046875e+07, 3.253664427734375e+06, 3.7271611953125e+06, 1.7635227181640625e+07),
            (2.4327148767578125e+07, 2.72106331640625e+06, 4.219134189453125e+06, 1.738695126171875e+07),
            (2.561848333984375e+07, 3.11645862109375e+06, 3.487117048828125e+06, 1.9014907669921875e+07),
            (2.657278789453125e+07, 3.274407755859375e+06, 3.77439051171875e+06, 1.9523989626953125e+07),
            (2.5434301033203125e+07, 4.408342373046875e+06, 3.84598421484375e+06, 1.71799744453125e+07),
            (2.325672341796875e+07, 2.89601784765625e+06, 3.94318411328125e+06, 1.641752145703125e+07),
        ],
    },
    '1% Sampling Rate': {
        16: [
            (916982.0625, 159702.125, 111434.375, 645845.5625),
            (772715.375, 73029.875, 73966.625, 625718.875),
            (324661.875, 55345.6875, 57947.5, 211368.6875),
            (299210.125, 70621.9375, 57387.4375, 171200.75),
            (328193.0625, 64988.6875, 51500.5, 211703.875),
            (909507.125, 169584.5, 168465.125, 571457.5),
            (389315.3125, 92719.9375, 70674.5625, 225920.8125),
            (301686.6875, 53140.625, 56421.25, 192124.8125),
            (473600.125, 72000.1875, 104290.0625, 297309.875),
            (426916.5625, 77900.125, 81460.3125, 267556.125),
        ],
        32: [
            (2.10482040625e+06, 149517.90625, 150183.96875, 1.80511853125e+06),
            (2.208246375e+06, 141938.25, 139132.625, 1.9271755e+06),
            (1.0160755625e+06, 173962.84375, 157590.5625, 684522.15625),
            (942385.15625, 108314.03125, 202803.375, 631267.75),
            (1.96005828125e+06, 256288.34375, 357984.125, 1.3457858125e+06),
            (1.05981471875e+06, 136123.09375, 188061.375, 735630.25),
            (974613.90625, 142176.09375, 189544.59375, 642893.21875),
            (1.46437503125e+06, 129762.09375, 305281.5, 1.0293314375e+06),
            (838267.96875, 117175.125, 132069.59375, 589023.25),
            (959371.4375, 131261.96875, 209639.78125, 618469.6875),
        ],
        64: [
            (1.964295703125e+06, 165636.984375, 401504.015625, 1.397154703125e+06),
            (1.701427609375e+06, 217152.28125, 364431.25, 1.119844078125e+06),
            (1.84005065625e+06, 190815.3125, 372933.75, 1.27630159375e+06),
            (2.158347484375e+06, 249550.75, 387537.171875, 1.5212595625e+06),
            (1.185165109375e+06, 194983.34375, 274972.25, 715209.515625),
            (1.861400046875e+06, 182665.5625, 320963.25, 1.357771234375e+06),
            (1.197247203125e+06, 160802.671875, 244068.421875, 792376.109375),
            (2.183359015625e+06, 258487, 416069.4375, 1.508802578125e+06),
            (1.199815234375e+06, 194000.328125, 233158.046875, 772656.859375),
            (1.29608909375e+06, 169211.125, 197113.953125, 929764.015625),
        ],
        128: [
            (4.202397125e+06, 484199.34375, 730977.09375, 2.9872206875e+06),
            (2.4477118828125e+06, 368371.46875, 488957.3828125, 1.59038303125e+06),
            (3.715343803149606e+06, 501439.52755905513, 765442.5196850394, 2.448461755905512e+06),
            (4.0400073385826773e+06, 776368.4251968504, 887952.7007874015, 2.3756862125984253e+06),
            (3.27895228125e+06, 515213.4921875, 727894.71875, 2.0358440703125e+06),
            (4.5319341796875e+06, 1.031381828125e+06, 1.011568e+06, 2.4889843515625e+06),
            (3.619260328125e+06, 489690.703125, 685855.484375, 2.443714140625e+06),
            (3.0965536015625e+06, 496276.6640625, 741910.9921875, 1.8583659453125e+06),
            (3.198415015625e+06, 512092.28125, 607236.375, 2.079086359375e+06),
            (4.74737825e+06, 568489, 661894.546875, 3.516994703125e+06),
        ],
        256: [
            (8.6135942109375e+06, 823642.546875, 2.05844323828125e+06, 5.73150842578125e+06),
            (9.93688687890625e+06, 1.22469860546875e+06, 2.30908061328125e+06, 6.40310766015625e+06),
            (1.09022195703125e+07, 1.149575265625e+06, 1.61453531640625e+06, 8.13810898828125e+06),
            (8.820590828125e+06, 1.90589605078125e+06, 2.30260967578125e+06, 4.6120851015625e+06),
            (7.4781569765625e+06, 1.18769302734375e+06, 2.094134171875e+06, 4.19632977734375e+06),
            (6.491725359375e+06, 1.032003375e+06, 957302.3515625, 4.5024196328125e+06),
            (1.058435728515625e+07, 1.63705337890625e+06, 1.79731359765625e+06, 7.14999030859375e+06),
            (1.094888401171875e+07, 1.19859563671875e+06, 1.56573512890625e+06, 8.18455324609375e+06),
            (7.62391616796875e+06, 1.25132123828125e+06, 1.523727375e+06, 4.8488675546875e+06),
            (6.6484239296875e+06, 1.1405576171875e+06, 949155.44921875, 4.55871086328125e+06),
        ],
        384: [
            (1.2868317572916666e+07, 1.4933322265625e+06, 2.2648085364583335e+06, 9.110176809895834e+06),
            (1.26038131484375e+07, 1.8530169140625e+06, 3.09683315625e+06, 7.653963078125e+06),
            (1.3764219002604166e+07, 2.5356766041666665e+06, 2.2290104166666665e+06, 8.999531981770834e+06),
            (1.3870054466145834e+07, 2.0439051640625e+06, 2.8842024114583335e+06, 8.941946890625e+06),
            (1.6438956864583334e+07, 1.932715296875e+06, 2.6721819869791665e+06, 1.1834059580729166e+07),
            (1.1335027877284596e+07, 1.768314088772846e+06, 2.157928096605744e+06, 7.408785691906005e+06),
            (1.2764826718015665e+07, 1.838779718015666e+06, 3.210282924281984e+06, 7.715764075718015e+06),
            (1.2892304380208334e+07, 1.9724122265625e+06, 3.49899015625e+06, 7.420901997395833e+06),
            (1.5246306245430809e+07, 2.4361435248041777e+06, 3.107239039164491e+06, 9.70292368146214e+06),
            (1.6032099544270834e+07, 1.590100578125e+06, 3.3533277786458335e+06, 1.10886711875e+07),
        ],
        512: [
            (1.833924126171875e+07, 3.03050664453125e+06, 4.065569978515625e+06, 1.1243164638671875e+07),
            (1.7998644474609375e+07, 2.74496198828125e+06, 3.785473994140625e+06, 1.14682084921875e+07),
            (1.646417560546875e+07, 2.675251232421875e+06, 3.902240466796875e+06, 9.88668390625e+06),
            (1.945046828125e+07, 2.279815525390625e+06, 4.17853581640625e+06, 1.2992116939453125e+07),
            (1.8078486205078125e+07, 2.7143297578125e+06, 4.223311640625e+06, 1.1140844806640625e+07),
            (1.5939567171875e+07, 2.594564427734375e+06, 3.42333001953125e+06, 9.921672724609375e+06),
            (1.80273282734375e+07, 2.73424761328125e+06, 3.419789935546875e+06, 1.1873290724609375e+07),
            (1.6684127966796875e+07, 2.318932328125e+06, 3.20914065625e+06, 1.1156054982421875e+07),
            (2.149726397265625e+07, 2.8394978359375e+06, 4.555781458984375e+06, 1.4101984677734375e+07),
            (1.9657695685546875e+07, 2.538489828125e+06, 4.062870775390625e+06, 1.305633508203125e+07),
        ],
    },
    "No Proxy": {
        16: [
            (451849.625, 73333.375, 227767.0625, 150749.1875),
            (267950.9375, 74645.9375, 71530.375, 121774.625),
            (129123.875, 37436.625, 16155.375, 75531.875),
            (142773.6875, 37092.3125, 13442.125, 92239.25),
            (249106.625, 34680, 12786.0625, 201640.5625),
            (210999.6875, 100311.375, 40701.3125, 69987),
            (329678.8125, 141158.375, 58304.8125, 130215.625),
            (173326.3125, 35660.75, 14256.5625, 123409),
            (145312.125, 39090.8125, 12821.9375, 93399.375),
            (122514.5625, 35525.8125, 13499.375, 73489.375),
        ],
        32: [
            (309551.96875, 46013.75, 81648.5625, 181889.65625),
            (439189.0625, 63067, 86334.5625, 289787.5),
            (479983.0625, 67492, 105323.3125, 307167.75),
            (332535.875, 45112.375, 88624.625, 198798.875),
            (831689.875, 151234.96875, 133868.03125, 546586.875),
            (1195001.5, 199675.03125, 364609.1875, 630717.28125),
            (436386.71875, 62756.0625, 88977.09375, 284653.5625),
            (459434.28125, 63766.34375, 98776.15625, 296891.78125),
            (470786.4375, 81762.21875, 96740.84375, 292283.375),
            (477615.6875, 69776.5625, 91857.375, 315981.75),
        ],
        64: [
            (862791.28125, 114466.703125, 190390.859375, 557933.71875),
            (938645.859375, 152985.25, 212412.09375, 573248.515625),
            (962039.734375, 153655.34375, 209558.203125, 598826.1875),
            (663611.828125, 96049.375, 174424.9375, 393137.515625),
            (962044.484375, 135184.046875, 193834.875, 633025.5625),
            (1035993.984375, 173899.5625, 227761.734375, 634332.6875),
            (1007255.046875, 160446.171875, 224712.1875, 622096.6875),
            (1031803.171875, 153525.15625, 223072.53125, 655205.484375),
            (1585640.921875, 155520.875, 285437.484375, 1144682.5625),
            (2342260.53125, 336079.890625, 525547.28125, 1480633.359375),
        ],
        128: [
            (1955033.375, 392182.3671875, 559874.875, 1002976.1328125),
            (1950263.2890625, 297095.703125, 433512.2265625, 1219655.359375),
            (1961558.0390625, 326583.7265625, 455716.0546875, 1179258.2578125),
            (4170416.015625, 261282.765625, 1366620.1015625, 2542513.1484375),
            (2095498.1875, 316479.8203125, 516875.4921875, 1262142.875),
            (1484437.0390625, 231547.875, 377027.8828125, 875861.28125),
            (3724693.6484375, 421081.546875, 874313.2109375, 2429298.890625),
            (1884653.25, 317563.5234375, 406776.6640625, 1160313.0625),
            (2750604.3515625, 547876.9375, 762894.1015625, 1439833.3125),
            (1700473.0546875, 311506.75, 499157.84375, 889808.4609375),
        ],
        256: [
            (6457372.12890625, 1045714.5078125, 2087226.20703125, 3324431.4140625),
            (3527986.0078125, 648875.60546875, 991760.37109375, 1887350.03125),
            (4091500.40625, 758719.62890625, 1071032.90625, 2261747.87109375),
            (5525747.56640625, 874385.65625, 1655636.62890625, 2995725.28125),
            (4143495.0390625, 642209.3203125, 1016547.59375, 2484738.125),
            (6166356.89453125, 745453.4453125, 1170415.38671875, 4250488.0625),
            (5076030.7109375, 618709.4296875, 930309.8046875, 3527011.4765625),
            (6472285.36328125, 836206.0390625, 1888086.7734375, 3747992.55078125),
            (6295072.35546875, 1665380.2109375, 2035744.70703125, 2593947.4375),
            (5694877.23828125, 634685.53125, 1385376.11328125, 3674815.59375),
        ],
        384: [
            (6805410.424479167, 1258810.2682291667, 1528979.1302083333, 4017621.0260416665),
            (7898338.7734375, 1436572.28125, 1912804.9583333333, 4548961.533854167),
            (8073733.875, 1415025.1770833333, 1903971.5052083333, 4754737.192708333),
            (8527730.088541666, 1412336.5807291667, 1949631.34375, 5165762.1640625),
            (9665613.169270834, 1295615.4244791667, 2074223.5520833333, 6295774.192708333),
            (8806590.880208334, 1338306.78125, 1898134.8359375, 5570149.263020833),
            (10337655.307291666, 2030668.7239583333, 3538208.5703125, 4768778.013020833),
            (10261924.752604166, 2484961.9921875, 2995248.3463541665, 4781714.4140625),
            (8220864.869791667, 2000656.6276041667, 1935095.734375, 4285112.5078125),
            (7690637.5859375, 1238002.7890625, 1645142.7421875, 4807492.0546875),
        ],
        512: [
            (11265212.287109375, 1615711.748046875, 3765457.10546875, 5884043.43359375),
            (10790639.001953125, 1996784.90625, 3461845.423828125, 5332008.671875),
            (12783884.560546875, 2222527.3828125, 4473646.46875, 6087710.708984375),
            (12483187.25, 2248529.310546875, 3147220.6015625, 7087437.337890625),
            (12724714.234375, 2592076.126953125, 3654900.248046875, 6477737.859375),
            (11938021.72265625, 2084350.93359375, 2712283.4375, 7141387.3515625),
            (11747561.11328125, 2478288.142578125, 3374424.693359375, 5894848.27734375),
            (11244903.26953125, 1797917.189453125, 2548973.39453125, 6898012.685546875),
            (11523814.068359375, 2706995.34765625, 2769832.005859375, 6046986.71484375),
            (10040261.3203125, 1596779.71484375, 2283087.349609375, 6160394.255859375),
        ],
    },
}

# ============================================================
# PLOTTING
# ============================================================

def main():
    line_list = sorted(data.keys())
    ue_counts = sorted(list(data[line_list[0]].keys()))

    # Figure with 4 subplots
    fig, axs = plt.subplots(2, 2, figsize=(8, 8))
    axs = axs.flatten()

    titles = [
        "Total Registration Time",
        "NAS Reg. Req. → NAS Auth. Req.",
        "NAS Auth. Res. → NAS SecModeCmd",
        "NAS SecModeComplete → IniCtxSetup Req."
    ]

    metric_index = [0, 1, 2, 3]  # which value in the tuple

    for plot_idx in range(4):
        ax = axs[plot_idx]
        mi = metric_index[plot_idx]

        for line in line_list:
            scatter_x = []
            scatter_y = []
            avg_y = []

            for ue in ue_counts:
                samples = data[line][ue]

                vals = np.array([row[mi] for row in samples]) / 1e6
                avg = np.average(vals)
                avg_y.append(avg)

                scatter_x.extend([ue] * len(vals))
                scatter_y.extend(vals)

            # scatter
            ax.scatter(scatter_x, scatter_y, s=2.5, alpha=0.70, label=f'{line}')

            # average line
            ax.plot(ue_counts, avg_y, linewidth=0.8)

        ax.set_title(titles[plot_idx])
        ax.set_xlabel("User Equipment Count")
        ax.set_ylabel("Duration (s)")
        ax.grid(True, linestyle='--', linewidth=0.4, alpha=0.6)
        ax.legend(fontsize=7)

    plt.tight_layout()
    plt.savefig("proxy_latencies.png", dpi=300)

if __name__ == "__main__":
    main()